#include <tunables/global>

profile cloudsuitedata-cachingclient_profile flags=(audit,attach_disconnected,mediate_deleted) {
	/etc/ld.so.cache r,
	/usr/src/memcached/twitter_dataset/twitter_dataset_30x r,
	/usr/ r,
	/lib/x86_64-linux-gnu/libtinfo.so.5.9 r,
	/var/lib/docker/* r, #Access to layers of filesystem
	/usr/src/memcached/memcached_client/ r,
	/usr/lib/x86_64-linux-gnu/libevent-2.0.so.5.1.9 r,
	/usr/src/memcached/twitter_dataset/twitter_dataset_unscaled r,
	file,  #Allows access to containers filesystem
	network inet stream,
	signal (receive) set=(kill) peer=unconfined,
	/usr/src/ r,
	network inet dgram,
	/usr/src/memcached/ r,
	signal (receive) set=(exists) peer=unconfined,
	/usr/src/memcached/memcached_client/loader ix,
	deny ptrace (readby, tracedby), #Confront container breakout attacks
}
